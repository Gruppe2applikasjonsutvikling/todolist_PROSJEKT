<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>test client</title>
    <script src="superfetch2.js"></script>
</head>

<body>

    <input id="inpLoginname" placeholder="Loginname">
    <input id="inpPassword" placeholder="Password">
    <button id="btnLogin">Log in</button>
    <p id="error"></p>

    <p id="otherPage"><a href="createuser.html">Create User</a></p>

</body>

<script>



    var inpLoginname = document.getElementById("inpLoginname");
    var inpPassword = document.getElementById("inpPassword");
    var btnCreate = document.getElementById("btnLogin");
    var p = document.getElementById("error");

    //button click ---------------------------------
    btnLogin.onclick = function() {

        var upload = JSON.stringify({
            loginname: inpLoginname.value,
            password: inpPassword.value
        });

        //var url = "http://localhost:8080/todo/users/auth/";
        var url = "https://krollparantes.herokuapp.com//todo/users/auth/";

        var cfg = {
            method: "POST",
            body: upload
        }

        superfetch(url, "json", succ, error, cfg);
    }

    //success --------------------------------------
    function succ(data) {

        //save logindata/token to localStorage
        localStorage.setItem("logindata", JSON.stringify(data));
        window.location.assign("https://krollparantes.herokuapp.com/todolist.html");
    }

    //error ----------------------------------------
    function error(err) {
        console.log(err);
        p.innerHTML = "Feil brukernavn eller passord!";

    }


</script>

</html>

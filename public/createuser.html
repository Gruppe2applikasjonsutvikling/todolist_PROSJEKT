<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>test client</title>
    <script src="superfetch2.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div id="hovedelement">
        <div id="logo"><img src="Logo.png" alt="logo" width="40%"></div>
        <input id="inpLoginname" placeholder="Loginname">
        <input id="inpPassword" placeholder="Password">
        <input id="inpFullname" placeholder="Full name">
        <button id="btnCreate">Create User</button>
        <p id="usererr"></p>
    </div>

</body>

<script>



    var inpLoginname = document.getElementById("inpLoginname");
    var inpPassword = document.getElementById("inpPassword");
    var inpFullname = document.getElementById("inpFullname");
    var btnCreate = document.getElementById("btnCreate");
    var p = document.getElementById("usererr");

    //button click ---------------------------------
    btnCreate.onclick = function() {


        var upload = JSON.stringify({
            loginname: inpLoginname.value,
            password: inpPassword.value,
            fullname: inpFullname.value
        });


        //var url = "http://localhost:8000/todo/users/";

        var url = "https://krollparantes.herokuapp.com/todo/users";
        //var url = "todo/users";

        var cfg = {
            method: "POST",
            body: upload
        }

        superfetch(url, "json", succ, error, cfg);
        console.log(upload);
        console.log("superfetch ferdig");

    }


     //success --------------------------------------
    function succ(data) {
        console.log(data);
        console.log("f√•r vi en suksess?");

        //save logindata/token to localStorage


        localStorage.setItem("logindata", JSON.stringify(data));
        //window.location.assign("https://krollparantes.herokuapp.com");
        console.log("suksess!");

    }

    //error ----------------------------------------
    function error(err) {
        console.log(err);
        console.log("Her skjer det en feil");
        p.innerHTML = "User already exists, or database error idk";
    }


</script>

</html>
